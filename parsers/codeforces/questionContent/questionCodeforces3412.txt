D2. Submarine in the Rybinsk Sea (hard edition)
time limit per test2 seconds
memory limit per test256 megabytes
inputstandard input
outputstandard output
This problem differs from the previous one only in the absence of the constraint on the equal length of all numbers
a
1
,
a
2
,…,
a
n
.
A team of SIS students is going to make a trip on a submarine. Their target is an ancient treasure in a sunken ship lying on the bottom of the Great Rybinsk sea. Unfortunately, the students don't know the coordinates of the ship, so they asked Meshanya (who is a hereditary mage) to help them. He agreed to help them, but only if they solve his problem.
Let's denote a function that alternates digits of two numbers
f(
a
1
a
2
…
a
p−1
a
p
,
b
1
b
2
…
b
q−1
b
q
)
, where
a
1
…
a
p
and
b
1
…
b
q
are digits of two integers written in the decimal notation without leading zeros.
In other words, the function
f(x,y)
alternately shuffles the digits of the numbers
x
and
y
by writing them from the lowest digits to the older ones, starting with the number
y
. The result of the function is also built from right to left (that is, from the lower digits to the older ones). If the digits of one of the arguments have ended, then the remaining digits of the other argument are written out. Familiarize with examples and formal definitions of the function below.
For example:
f(1111,2222)=12121212
f
(
1111
2222
)
12121212
f(7777,888)=7787878
f
(
7777
888
)
7787878
f(33,44444)=4443434
f
(
33
44444
)
4443434
f(555,6)=5556
f
(
555
6
)
5556
f(111,2222)=2121212
f
(
111
2222
)
2121212
Formally,
if
p≥q
then
f(
a
1
…
a
p
,
b
1
…
b
q
)=
a
1
a
2
…
a
p−q+1
b
1
a
p−q+2
b
2
…
a
p−1
b
q−1
a
p
b
q
;
if
p<q
then
f(
a
1
…
a
p
,
b
1
…
b
q
)=
b
1
b
2
…
b
q−p
a
1
b
q−p+1
a
2
…
a
p−1
b
q−1
a
p
b
q
.
Mishanya gives you an array consisting of
n
integers
a
i
, your task is to help students to calculate
∑
n
i=1
∑
n
j=1
f(
a
i
,
a
j
)
modulo
998244353
.
Input
The first line of the input contains a single integer
n
(
1≤n≤100000
) — the number of elements in the array. The second line of the input contains
n
integers
a
1
,
a
2
,…,
a
n
(
1≤
a
i
≤
10
9
) — the elements of the array.
Output
Print the answer modulo
998244353
.
Examples
input
Copy
3
12 3 45
output
Copy
12330
input
Copy
2
123 456
output
Copy
1115598