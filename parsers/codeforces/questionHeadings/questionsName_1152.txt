E2. Distance Tree (hard version)