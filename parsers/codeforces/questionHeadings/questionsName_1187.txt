E2. Cats on the Upgrade (hard version)