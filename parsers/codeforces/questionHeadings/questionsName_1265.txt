D2. Divan and Kostomuksha (hard version)