F2. Survival of the Weakest (hard version)