D2. Mocha and Diana (Hard Version)