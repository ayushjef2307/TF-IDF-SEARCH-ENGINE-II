D2. Domino (hard version)