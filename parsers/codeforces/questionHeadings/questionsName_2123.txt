H2. Multithreading (Hard Version)