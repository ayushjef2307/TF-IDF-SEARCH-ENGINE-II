D2. Sage's Birthday (hard version)