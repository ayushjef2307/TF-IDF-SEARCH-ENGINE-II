F2. Chess Strikes Back (hard version)