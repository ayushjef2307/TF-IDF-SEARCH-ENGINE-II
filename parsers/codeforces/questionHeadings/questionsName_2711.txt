E2. Chiori and Doll Picking (hard version)