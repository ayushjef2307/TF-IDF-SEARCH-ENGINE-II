D2. Prefix-Suffix Palindrome (Hard version)