C2. Skyscrapers (hard version)