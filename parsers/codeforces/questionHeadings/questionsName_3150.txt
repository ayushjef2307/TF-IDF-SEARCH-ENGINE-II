C2. Good Numbers (hard version)