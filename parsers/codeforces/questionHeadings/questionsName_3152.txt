B2. Books Exchange (hard version)