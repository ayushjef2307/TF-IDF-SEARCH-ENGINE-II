G2. Into Blocks (hard version)