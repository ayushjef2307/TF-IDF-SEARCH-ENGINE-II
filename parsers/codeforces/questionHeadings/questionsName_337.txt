A2. Gardener and the Capybaras (hard version)