F2. Magician and Pigs (Hard Version)