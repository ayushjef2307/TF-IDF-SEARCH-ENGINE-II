D2. Submarine in the Rybinsk Sea (hard edition)