G. Candy Box (hard version)