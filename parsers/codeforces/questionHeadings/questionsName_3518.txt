B. Digits Sequence (Hard Edition)