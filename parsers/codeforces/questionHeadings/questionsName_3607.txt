C2. Increasing Subsequence (hard version)