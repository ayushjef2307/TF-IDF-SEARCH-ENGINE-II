D2. Coffee and Coursework (Hard Version)