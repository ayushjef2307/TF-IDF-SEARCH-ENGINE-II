F2. Pictures with Kittens (hard version)