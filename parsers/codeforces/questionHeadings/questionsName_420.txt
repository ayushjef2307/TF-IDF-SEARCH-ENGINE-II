G3. Doremy's Perfect DS Class (Hard Version)