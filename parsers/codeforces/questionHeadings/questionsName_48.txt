B2. LuoTianyi and the Floating Islands (Hard Version)