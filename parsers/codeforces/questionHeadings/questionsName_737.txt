D2. Chopping Carrots (Hard Version)