H2. Game of AI (hard version)