H2. Maximum Crossings (Hard Version)